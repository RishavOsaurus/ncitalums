---
const startYear = 2000;
const currentYear = new Date().getFullYear();
const yearsRange = Array.from({ length: currentYear - startYear + 1 }, (_, i) => startYear + i);
---

<nav class="flex flex-col md:flex-row bg-gray-800 text-white p-4 w-full fixed z-10">
  <div class="flex items-center justify-between md:w-1/3">
    <div class="text-lg font-bold">Open Alumn Portal</div>
    <button id="menuToggle" aria-expanded="false" class="md:hidden">
      <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
      </svg>
    </button>
  </div>

  <ul id="navLinks" class="flex flex-col md:flex-row md:justify-center md:flex-1 md:space-x-6 mt-2 md:mt-0">
    <li><a href="/" class="hover:text-gray-300">Home</a></li>
    <li class="relative">
      <button id="directoryToggle" class="hover:text-gray-300 focus:outline-none">Alumni Directory</button>
      <!-- Mega Menu -->
      <div id="megaMenu" class="absolute left-0 hidden bg-white text-black p-4 shadow-lg mt-2 rounded-md z-20">
        <div class="flex flex-col">
          <h3 class="font-bold mb-2">Graduation Years</h3>
          <nav class="w-64">
            <ul class="grid grid-cols-2 gap-2">
              {yearsRange.map((year) => (
                  <li key={year}>
                    <a href={`/profiles/${year}`} class="text-gray-700 hover:text-blue-600">{year}</a>
                  </li>
              ))}
            </ul>
            <h3 class="font-bold mt-4 mb-2">Departments</h3>
            <ul>
              <li><a href="/profiles/it" class="text-gray-700 hover:text-blue-600">IT</a></li>
              <li><a href="/profiles/elx" class="text-gray-700 hover:text-blue-600">ELX</a></li>
              <li><a href="/profiles/cmp" class="text-gray-700 hover:text-blue-600">COMP</a></li>
              <li><a href="/profiles/se" class="text-gray-700 hover:text-blue-600">SE</a></li>
              <li><a href="/profiles/civil" class="text-gray-700 hover:text-blue-600">CIVIL</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </li>
    <li><a href="/events" class="hover:text-gray-300">Events</a></li>
    <li><a href="/blog" class="hover:text-gray-300">Blog</a></li>
    <li><a href="/about" class="hover:text-gray-300">About</a></li>
    <li><a href="/contact" class="hover:text-gray-300">Contact Us</a></li>
  </ul>

  <div class="flex items-center mt-2 md:mt-0 md:ml-auto">
    <div class="relative flex-1">
      <input type="text" placeholder="Search..." class="border rounded-md p-2 w-full focus:outline-none focus:ring focus:border-blue-300" />
      <button class="absolute right-0 top-0 mt-2 mr-2">
        <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h-1l-4-4H7a5 5 0 100 10h10a5 5 0 000-10H15l4 4"></path>
        </svg>
      </button>
    </div>
    <button class="ml-4 bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md">Sign In</button>
  </div>
</nav>

<script is:client="load">
  const menuToggle = document.getElementById('menuToggle');
  const navLinks = document.getElementById('navLinks');
  const directoryToggle = document.getElementById('directoryToggle');
  const megaMenu = document.getElementById('megaMenu');

  menuToggle.addEventListener('click', () => {
    navLinks.classList.toggle('hidden');
    const isExpanded = navLinks.classList.contains('hidden') ? 'false' : 'true';
    menuToggle.setAttribute('aria-expanded', isExpanded);
  });

  directoryToggle.addEventListener('click', () => {
    megaMenu.classList.toggle('hidden');
  });
</script>
